import{_ as U,x as A,A as r,C as D,D as F,L as u,r as l,F as a,a6 as b,H as P,a7 as p,ab as V,K as s,a8 as g,aw as j,M as v,E,N as m,ay as k,ai as w,G as L,a9 as W,O as z}from"./index-9d77904b.js";import{g as G}from"./index-0fa819ad.js";import{V as H}from"./VContainer-549e10d5.js";import{V as S,a as $}from"./VRow-a5167093.js";const I={class:"mb-2"},K={class:"mb-2"},M={class:"mb-2"},O={class:"mb-2"},q={class:"mb-2"},J={class:"mb-2"},Q={__name:"BookingSearch",setup(X){const{api:c}=z(),B=A(),_=r(""),t=r(null),y=r(!1),x=r(null),n=r(!1),d=r(!1),i=r(!1),C=r(!1),T=async()=>{var f;if(/^\d{10}$/.test(_.value)){i.value=!1,d.value=!1,n.value=!1,C.value=!0;try{const{data:e}=await c.get(`/reservations/${_.value}`);e.success&&e.result?(t.value=e.result,y.value=!0,i.value=!0,await W(),(f=x.value)!=null&&f.$el&&G.from(x.value.$el,{opacity:0,y:50,duration:.6,ease:"power3.out"})):(t.value=null,y.value=!0,d.value=!0,i.value=!1)}catch{t.value=null,y.value=!0,d.value=!0}finally{C.value=!1}}},N=async()=>{n.value=!1;try{await c.delete(`/reservations/cancelByCustomer/${t.value._id}`),t.value=null,B({text:"已取消訂位",snackbarProps:{color:"green"}})}catch{B({text:"取消失敗",snackbarProps:{color:"red"}})}i.value=!1,d.value=!1,n.value=!1},R=f=>new Date(f).toLocaleDateString("zh-TW");return(f,e)=>(D(),F(P,null,[e[22]||(e[22]=u("h1",{class:"bg-img"},"查詢訂位",-1)),l(H,null,{default:a(()=>[l(S,{justify:"center"},{default:a(()=>[l($,{cols:"12",md:"6"},{default:a(()=>[l(p,{class:"pa-6 elevation-3"},{default:a(()=>[l(V,{class:"text-h5 font-weight-bold mb-4"},{default:a(()=>e[8]||(e[8]=[s("請輸入電話號碼查詢")])),_:1,__:[8]}),l(g,null,{default:a(()=>[l(j,{label:"電話號碼",modelValue:_.value,"onUpdate:modelValue":e[0]||(e[0]=o=>_.value=o),type:"tel",maxlength:"10","prepend-icon":"mdi-phone",variant:"outlined",density:"comfortable","error-messages":_.value.length!==10?"請輸入 10 位數字電話號碼":""},null,8,["modelValue","error-messages"]),l(v,{class:"mt-4",color:"primary",block:"",onClick:T,loading:C.value},{default:a(()=>e[9]||(e[9]=[s("查詢")])),_:1,__:[9]},8,["loading"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),l(b,{modelValue:i.value,"onUpdate:modelValue":e[3]||(e[3]=o=>i.value=o),"max-width":"500",persistent:""},{default:a(()=>[l(S,{class:"mt-6",justify:"center"},{default:a(()=>[l($,{cols:"12",md:"8"},{default:a(()=>[t.value?(D(),E(p,{key:0,class:"pa-4 elevation-2",ref_key:"resultCardRef",ref:x},{default:a(()=>[l(V,{class:"text-h5"},{default:a(()=>e[10]||(e[10]=[s("訂位資訊")])),_:1,__:[10]}),l(g,null,{default:a(()=>[u("div",I,"姓名："+m(t.value.name),1),u("div",K,"電話："+m(t.value.phone),1),u("div",M,"人數："+m(t.value.peopleCount),1),u("div",O,"日期："+m(R(t.value.reservationDate)),1),u("div",q,"時段："+m(t.value.timePeriod),1),u("div",J,"時間："+m(t.value.reservationTime),1),e[11]||(e[11]=u("hr",{class:"my-4"},null,-1)),e[12]||(e[12]=u("p",{class:"text-body-2 text-grey-darken-1"},"訂位將保留 15 分鐘，請準時到店用餐。",-1))]),_:1,__:[11,12]}),l(k,null,{default:a(()=>[l(w),l(v,{color:"primary",onClick:e[1]||(e[1]=o=>i.value=!1)},{default:a(()=>e[13]||(e[13]=[s("確認")])),_:1,__:[13]}),l(v,{color:"error",onClick:e[2]||(e[2]=o=>n.value=!0)},{default:a(()=>e[14]||(e[14]=[s("取消訂位")])),_:1,__:[14]})]),_:1})]),_:1},512)):L("",!0)]),_:1})]),_:1})]),_:1},8,["modelValue"]),l(b,{modelValue:d.value,"onUpdate:modelValue":e[5]||(e[5]=o=>d.value=o),"max-width":"400"},{default:a(()=>[l(p,null,{default:a(()=>[l(V,{class:"text-h6"},{default:a(()=>e[15]||(e[15]=[s("查無資料")])),_:1,__:[15]}),l(g,null,{default:a(()=>e[16]||(e[16]=[s("查無此電話的訂位紀錄，請重新確認。")])),_:1,__:[16]}),l(k,null,{default:a(()=>[l(w),l(v,{color:"primary",onClick:e[4]||(e[4]=o=>d.value=!1)},{default:a(()=>e[17]||(e[17]=[s("確認")])),_:1,__:[17]})]),_:1})]),_:1})]),_:1},8,["modelValue"]),l(b,{modelValue:n.value,"onUpdate:modelValue":e[7]||(e[7]=o=>n.value=o),"max-width":"400"},{default:a(()=>[l(p,null,{default:a(()=>[l(V,{class:"text-h6",style:{"font-weight":"bold"}},{default:a(()=>e[18]||(e[18]=[s("確認取消")])),_:1,__:[18]}),l(g,null,{default:a(()=>e[19]||(e[19]=[s("確定要取消此次訂位嗎？")])),_:1,__:[19]}),l(k,null,{default:a(()=>[l(w),l(v,{color:"primary",onClick:e[6]||(e[6]=o=>n.value=!1)},{default:a(()=>e[20]||(e[20]=[s("關閉")])),_:1,__:[20]}),l(v,{color:"red",onClick:N},{default:a(()=>e[21]||(e[21]=[s("取消訂位")])),_:1,__:[21]})]),_:1})]),_:1})]),_:1},8,["modelValue"])],64))}},le=U(Q,[["__scopeId","data-v-95b30a3e"]]);export{le as default};
