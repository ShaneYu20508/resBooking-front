import{x as D,A as d,T as h,C as w,E as b,F as t,O as g,r as l,L as n,N as p,K as i,M as _,a7 as T,ab as W,a8 as S,ay as B,ai as N,a6 as A}from"./index-7f3591e3.js";import{V as P}from"./VContainer-31b83cef.js";import{a as x,V as R}from"./VRow-0a9a0ff3.js";import{V as $}from"./VDataTable-cb5afca6.js";import"./VSelect-98c0f73e.js";import"./VList-5cc45486.js";import"./ssrBoot-a6f07426.js";import"./VDivider-70911d59.js";const L={class:"text-red"},q={__name:"NoShows",setup(M){const{apiAuth:c}=g(),m=D(),v=d([]),u=d([]),r=d(!1),s=d(null),V=[{title:"姓名",key:"name",minWidth:"100px"},{title:"電話",key:"phone",minWidth:"120px"},{title:"訂位人數",key:"peopleCount",minWidth:"70px"},{title:"訂位日期",key:"reservationDate",minWidth:"140px"},{title:"時段",key:"timePeriod",minWidth:"70px"},{title:"時間",key:"reservationTime",minWidth:"80px"},{title:"操作",key:"actions",sortable:!1}],k=a=>new Date(a).toLocaleDateString("zh-TW"),y=a=>{s.value=a,r.value=!0},C=async()=>{try{await c.delete(`/reservations/cancelByCustomer/${s.value._id}`),v.value=v.value.filter(a=>a._id!==s.value._id),u.value=u.value.filter(a=>a._id!==s.value._id),m({text:"訂位已成功刪除",snackbarProps:{color:"green"}})}catch{m({text:"刪除失敗",snackbarProps:{color:"red"}})}finally{r.value=!1}};return h(async()=>{try{const{data:a}=await c.get("/reservations/noShow");v.value=a.result,u.value=a.result}catch{m({text:"無法取得訂位資料",snackbarProps:{color:"red"}})}}),(a,e)=>(w(),b(P,null,{default:t(()=>[l(R,null,{default:t(()=>[l(x,{cols:"12"},{default:t(()=>e[2]||(e[2]=[n("h1",null,"未到紀錄",-1)])),_:1,__:[2]}),l(x,{cols:"12"},{default:t(()=>[l($,{items:u.value,headers:V,"item-value":"_id"},{"item.phone":t(({item:o})=>[n("span",L,p(o.phone),1)]),"item.reservationDate":t(({item:o})=>[i(p(k(o.reservationDate)),1)]),"item.actions":t(({item:o})=>[l(_,{color:"red",onClick:f=>y(o)},{default:t(()=>e[3]||(e[3]=[i("刪除")])),_:2,__:[3]},1032,["onClick"])]),_:2},1032,["items"])]),_:1})]),_:1}),l(A,{modelValue:r.value,"onUpdate:modelValue":e[1]||(e[1]=o=>r.value=o),"max-width":"400px"},{default:t(()=>[l(T,null,{default:t(()=>[l(W,{class:"text-h6",style:{"font-weight":"bold"}},{default:t(()=>e[4]||(e[4]=[i("確認刪除")])),_:1,__:[4]}),l(S,null,{default:t(()=>{var o,f;return[e[5]||(e[5]=n("p",null,"確定要刪除此筆未到的訂位資料嗎？",-1)),n("p",null,"姓名："+p((o=s.value)==null?void 0:o.name),1),n("p",null,"電話："+p((f=s.value)==null?void 0:f.phone),1)]}),_:1,__:[5]}),l(B,null,{default:t(()=>[l(N),l(_,{text:"",onClick:e[0]||(e[0]=o=>r.value=!1)},{default:t(()=>e[6]||(e[6]=[i("關閉")])),_:1,__:[6]}),l(_,{color:"red",onClick:C},{default:t(()=>e[7]||(e[7]=[i("確定刪除")])),_:1,__:[7]})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1}))}};export{q as default};
